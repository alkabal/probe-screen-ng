o<psng_tool_lenght> sub
;o<psng_hook> call [10]

o<psng_config_check> call

o90 if [#<_hal[probe.setterheight]> LE 0]
     o<psng_hook_end> call
    (ABORT,TOOLSETTER HEIGHT NOT CONFIGURED)
o90 endif

o300 if [#<_current_tool> LT 1]
     o<psng_hook_end> call
     (ABORT,TOOLLENGHT WITH TOOL 0 NOT ALLOWED)
o300 endif

o<psng_goto_toolsensor> call                                               ; with G90 inside

(cancel all Z offsets)
G92.1                                                                      ; use pause can be better than reset ???
G49

o<psng_backup_offset> call
G10 L2 P0 Z0                                                               ; reset G54 offset for correct tool measurement

o<psng_start_setter_probing> call

#<touch_result> = [#5063 - #<_hal[probe.setterheight]>]
(print, probe Z=#<touch_result>)

G10 L1 P#<_current_tool> Z[#<touch_result>]
G10 L2 P0     Z#<_backup_offset>

G43

o<psng_goto_changepos> call
;o<psng_hook_end> call
o<psng_tool_lenght> endsub
M2
