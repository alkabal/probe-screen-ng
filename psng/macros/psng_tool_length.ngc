o<psng_tool_length> sub

o10 if [#<_hal[probe.setterheight]> LE 0]   ; AT THE END NEED TO CHOOSE #<_hal[probe.setterheight or #<_ini[TOOLSENSOR]TS_HEIGHT>
     o<psng_hook_end> call
    (ABORT,TOOLSETTER HEIGHT NOT PROBED/CONFIGURED)
o10 endif

o<psng_goto_toolsensor> call                                               ; with G90 inside

(cancel all Z offsets)
G92.1                                                                      ; use pause can be better than reset ???
G49

o<psng_coord_offset_backup> call                                                 ; backup G54 offset for correct calc tool measurement

o<psng_start_setter_probing> call
o500 if [#5070 EQ 0]
     o<psng_hook_end> call
    (ABORT,FAILURE : TOOL SETTER FOR TOOL LENGHT DOES NOT FOUND THE CONTACT POINT)
o500 endif

;#<_touch_result> = [#5063 - #<_hal[probe.setterheight]>]   ; AT THE END NEED TO CHOOSE #<_hal[probe.setterheight or #<_ini[TOOLSENSOR]TS_HEIGHT>
(print, probe Z=#<_touch_result>)

G10 L1 P#<_current_tool> Z[#<_touch_result>]

G43

o<psng_goto_changepos> call
o<psng_tool_length> endsub
M2
